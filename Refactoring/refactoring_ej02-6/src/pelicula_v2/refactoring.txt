Bad Smell: Long Method
Refactoring: Replace Conditional with Polymorphism